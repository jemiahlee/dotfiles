#!/usr/bin/perl

use warnings;
use strict;

use Getopt::Long;
use List::Util qw/any/;
use Scalar::Util qw/openhandle/;

my($verbose, $delimiter);
$delimiter = '';

GetOptions(
    'delimiter=s' => \$delimiter,
    'verbose'     => \$verbose,
);

my @filehandles;
foreach my $argv (@ARGV) {
    open my $fh, '<', $argv or die "Couldn't open $argv: $!";
    push @filehandles, $fh;
}

while(any {openhandle($_)} @filehandles) {
    my @outputs;

    foreach my $fh (@filehandles) {
        unless(openhandle($fh)) {
            push @outputs, '';
            next;
        }

        my $readline = <>;
        chomp $readline;
        push @outputs, $readline;
    }

    print(join($delimiter, @outputs), "\n");
}
